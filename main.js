!function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?e(Object(o),!0).forEach((function(e){n(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(t){var n=t.host,r=t.authorization;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._host=n,this._headers={authorization:r},this.userId=void 0}var n,o;return n=e,o=[{key:"_handleResponse",value:function(e){return e.ok?e.json():Promise.reject("error: ".concat(e.status,", ").concat(e.statusText))}},{key:"_handleError",value:function(e){console.log(e)}},{key:"getUserInfo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"me";return fetch("".concat(this._host,"/users/").concat(t),{headers:this._headers}).then(this._handleResponse).then((function(t){return e.userId=t._id,t})).catch(this._handleError)}},{key:"updateUserAvatar",value:function(e){return fetch("".concat(this._host,"/users/me/avatar"),{method:"PATCH",headers:t(t({},this._headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({avatar:e})}).then(this._handleResponse).catch(this._handleError)}},{key:"getCards",value:function(){return fetch("".concat(this._host,"/cards"),{headers:this._headers}).then(this._handleResponse).catch(this._handleError)}},{key:"updateUser",value:function(e){var n=e.name,r=e.about;return fetch("".concat(this._host,"/users/me"),{method:"PATCH",headers:t(t({},this._headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({name:n,about:r})}).then(this._handleResponse).catch(this._handleError)}},{key:"addCard",value:function(e){var n=e.name,r=e.link;return fetch("".concat(this._host,"/cards"),{method:"POST",headers:t(t({},this._headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({name:n,link:r})}).then(this._handleResponse).catch(this._handleError)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._host,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._handleResponse)}},{key:"addLike",value:function(e){return fetch("".concat(this._host,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._handleResponse)}},{key:"removeLike",value:function(e){return fetch("".concat(this._host,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._handleResponse).catch(this._handleError)}}],o&&r(n.prototype,o),e}();function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t,n,r,o){var i=t.name,a=t.link,c=t.likes,u=t.liked,s=o.addLike,l=o.removeLike,f=o.deleteCard;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=i,this._link=a,this._likeCount=c.length,this._isliked=u,this._cardSelector=n.cardSelector,this._cardTemplateSelector=n.cardTemplateSelector,this._cardTitleSelector=n.cardTitleSelector,this._cardImageSelector=n.cardImageSelector,this._cardLikeSelector=n.cardLikeSelector,this._cardLikesCounterSelector=n.cardLikeCounterSelector,this._cardDeleteSelector=n.cardDeleteSelector,this._handleLike=this._handleLikeClick.bind(this),this._handleDelete=this._handleCardDelete.bind(this),this._handlePicture=n.openPicture,this._confirm=r,this._addLikeApi=s,this._removeLikeApi=l,this._deleteCardApi=f,this._activeLikeButtonClass=n.activeLikeButtonClass}var t,n;return t=e,n=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardTemplateSelector).content.querySelector(this._cardSelector).cloneNode(!0)}},{key:"_handleCardDelete",value:function(){var e=this;this._confirm((function(){e._element.remove(),e._element=null,e._deleteCardApi()}))}},{key:"_handleLikeClick",value:function(){var e=this._element.querySelector(this._cardLikeSelector);this._isliked?(this._isliked=!1,this._likeCount--,e.classList.remove(this._activeLikeButtonClass),this._element.querySelector(this._cardLikesCounterSelector).textContent="".concat(this._likeCount),this._removeLikeApi()):(this._isliked=!0,this._likeCount++,e.classList.add(this._activeLikeButtonClass),this._element.querySelector(this._cardLikesCounterSelector).textContent="".concat(this._likeCount),this._addLikeApi())}},{key:"_addCardEvents",value:function(e){var t=this._element.querySelector(this._cardImageSelector),n=this._element.querySelector(this._cardLikeSelector),r=this._element.querySelector(this._cardDeleteSelector);e?r.addEventListener("click",this._handleDelete):r.remove(),t.addEventListener("click",this._handlePicture),n.addEventListener("click",this._handleLike)}},{key:"generateCard",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._element=this._getTemplate(),this._addCardEvents(e),this._element.querySelector(this._cardTitleSelector).textContent=this._name,this._element.querySelector(this._cardLikesCounterSelector).textContent=this._likeCount,this._isliked&&this._element.querySelector(this._cardLikeSelector).classList.add(this._activeLikeButtonClass);var t=this._element.querySelector(this._cardImageSelector);return t.src=this._link,t.alt=this._name,this._element}}],n&&i(t.prototype,n),e}(),c=a,u={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__save-button",inactiveButtonClass:"form__save-button_disabled",inputErrorClass:"form__input_error",errorClass:"form__input-error_visible"},s="popup_visible",l={cardSelector:".card",cardTemplateSelector:".card__template",cardTitleSelector:".card__title",cardImageSelector:".card__image",cardLikeSelector:".card__like-button",cardLikeCounterSelector:".card__like-counter",cardDeleteSelector:".card__delete-button",activeLikeButtonClass:"card__like-button_active"};function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,"_handleEscapeClose",(function(e){"Escape"===e.key&&n.close()})),h(this,"_handleOverlayClose",(function(e){e.target.classList.contains(s)&&n.close()})),this._element=document.querySelector(t),this._closeButton=this._element.querySelector(".popup__close-button"),this._handleCloseButton=function(){return n.close()}}var t,n;return t=e,(n=[{key:"open",value:function(){this._element.classList.add(s),this.setEventListeners()}},{key:"close",value:function(){this._element.classList.remove(s),this.removeEventListeners()}},{key:"setEventListeners",value:function(){this._closeButton.addEventListener("click",this._handleCloseButton),this._element.addEventListener("click",this._handleOverlayClose),document.addEventListener("keydown",this._handleEscapeClose)}},{key:"removeEventListeners",value:function(){this._closeButton.removeEventListener("click",this._handleCloseButton),this._element.removeEventListener("click",this._handleOverlayClose),document.removeEventListener("keydown",this._handleEscapeClose)}}])&&f(t.prototype,n),e}();function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){return v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},v(e,t)}function y(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t,n){return b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},b(e,t,n||e)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=S(t);if(n){var o=S(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return y(this,e)});function o(e,t){var n,i,a,c,s,l=t.handleSubmit,f=t.resetValidation;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),k(m(s=r.call(this,e)),"_setInputValues",(function(e){for(var t=function(){var e,t,o=(e=r[n],t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1],c=s._inputs.find((function(e){return e.name===i}));void 0!==c&&(c.value=a)},n=0,r=Object.entries(e);n<r.length;n++)t()})),k(m(s),"_getInputValues",(function(){var e={};return s._inputs.forEach((function(t){e[t.name]=t.value})),e})),k(m(s),"open",(function(e){s.setEventListeners(),s._setInputValues(e),b((n=m(s),S(o.prototype)),"open",n).call(n)})),k(m(s),"close",(function(){s.removeEventListeners(),s._resetValidation(),b((i=m(s),S(o.prototype)),"close",i).call(i),s._form.reset()})),k(m(s),"setEventListeners",(function(){s._form.addEventListener("submit",s._handleSubmit),b((a=m(s),S(o.prototype)),"setEventListeners",a).call(a)})),k(m(s),"removeEventListeners",(function(){s._form.removeEventListener("submit",s._handleSubmit),b((c=m(s),S(o.prototype)),"removeEventListeners",c).call(c)})),k(m(s),"toggleButtonText",(function(){var e=s._button.textContent;s._button.textContent=s._buttonText,s._buttonText=e})),s._handleSubmit=l.bind(m(s)),s._resetValidation=f,s._inputs=Array.from(s._element.querySelectorAll(u.inputSelector)),s._form=s._element.querySelector(u.formSelector),s._button=s._element.querySelector(u.submitButtonSelector),s._buttonText="Saving...",s}return o}(d);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t,n){return w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},w(e,t,n||e)}function C(e,t){return C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},C(e,t)}function L(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=j(r);if(o){var n=j(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return L(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._title=t._element.querySelector(".popup__picture-title"),t._image=t._element.querySelector(".popup__picture"),t}return t=a,(n=[{key:"open",value:function(e){var t=e.link,n=e.name;this._title.textContent=n,this._image.setAttribute("src",t),this._image.setAttribute("alt",n),w(j(a.prototype),"open",this).call(this)}}])&&O(t.prototype,n),a}(d);function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function B(e,t){return B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},B(e,t)}function I(e,t){if(t&&("object"===T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return R(e)}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(e,t,n){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},q(e,t,n||e)}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=x(t);if(n){var o=x(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return I(this,e)});function o(e,t){var n,i,a,c,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),D(R(u=r.call(this,e)),"open",(function(e){u._handleConfirm=function(){e(),u.close()},u.setEventListeners(),q((n=R(u),x(o.prototype)),"open",n).call(n)})),D(R(u),"close",(function(){u.removeEventListeners(),q((i=R(u),x(o.prototype)),"close",i).call(i)})),D(R(u),"setEventListeners",(function(){u._buttonElement.addEventListener("click",u._handleConfirm),q((a=R(u),x(o.prototype)),"setEventListeners",a).call(a)})),D(R(u),"removeEventListeners",(function(){u._buttonElement.removeEventListener("click",u._handleConfirm),q((c=R(u),x(o.prototype)),"removeEventListeners",c).call(c)})),u._handleConfirm=function(){return u.close()},u._buttonElement=u._element.querySelector(t),u}return o}(d);function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function e(t){var n=t.userNameSelector,r=t.descriptionSelector,o=t.avatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._nameElement=document.querySelector(n),this._bioElement=document.querySelector(r),this._imageElement=document.querySelector(o)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._nameElement.textContent,bio:this._bioElement.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;this._nameElement.textContent=t,this._bioElement.textContent=n}},{key:"setUserAvatar",value:function(e){this._imageElement.src=e}}])&&V(t.prototype,n),e}();function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var z=function(){function e(t,n){var r=t.inputSelector,o=t.submitButtonSelector,i=t.inactiveButtonClass,a=t.inputErrorClass,c=t.errorClass;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._form=n,this._inputSelector=r,this._submitButtonSelector=o,this._inactiveButtonClass=i,this._inputErrorClass=a,this._errorClass=c,this._boundHandleInput=this._handleInput.bind(this)}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){this._inputElements=this._form.querySelectorAll(this._inputSelector),this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._setEventListeners()}},{key:"resetValidation",value:function(){var e=this;this._inputElements.forEach((function(t){e._hideError(t)})),this._disableButton()}},{key:"_handleInput",value:function(e){this._validateInput(e.target),this._setButtonState()}},{key:"_validateInput",value:function(e){e.validity.valid?this._hideError(e):this._showError(e)}},{key:"_hideError",value:function(e){var t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)}},{key:"_showError",value:function(e){var t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}},{key:"_setEventListeners",value:function(){var e=this;this._inputElements.forEach((function(t){return t.addEventListener("input",e._boundHandleInput)}))}},{key:"_setButtonState",value:function(){this._hasInvalidInput()?this._disableButton():this._enableButton()}},{key:"_hasInvalidInput",value:function(){return Array.from(this._inputElements).some((function(e){return!e.validity.valid}))}},{key:"_disableButton",value:function(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0}},{key:"_enableButton",value:function(){this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1}}])&&H(t.prototype,n),e}();function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){$(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F=new o({host:"https://around.nomoreparties.co/v1/group-12",authorization:"9dcb4203-ec5d-4132-a4af-e260b13cb4d2"}),G=new U({userNameSelector:".profile__name",descriptionSelector:".profile__bio",avatarSelector:".profile__image"}),K=new P(".popup_name_picture"),Q=new g(".popup_name_edit-profile",{handleSubmit:function(e){var t=this;e.preventDefault(),this.toggleButtonText();var n=this._getInputValues(),r=n.name,o=n.bio;G.setUserInfo({name:r,about:o}),F.updateUser({name:r,about:o}).then((function(){t.close(),t.toggleButtonText()}))},resetValidation:function(){return ne.resetValidation()}}),W=new g(".popup_name_new-place",{handleSubmit:function(e){var t=this;e.preventDefault(),this.toggleButtonText();var n=this._getInputValues(),r=n.title,o=n.link;F.addCard({name:r,link:o}).then((function(e){return ie.addItem(e)})).then((function(){t.close(),t.toggleButtonText()}))},resetValidation:function(){return re.resetValidation()}}),X=new g(".popup_name_edit-avatar",{handleSubmit:function(e){var t=this;e.preventDefault(),this.toggleButtonText();var n=this._getInputValues().url;G.setUserAvatar(n),F.updateUserAvatar(n).then((function(){t.close(),t.toggleButtonText()}))},resetValidation:function(){return oe.resetValidation()}}),Y=new A(".popup_name_confirm",u.submitButtonSelector),Z=document.querySelector(".form_name_edit-profile"),ee=document.querySelector(".form_name_new-place"),te=document.querySelector(".form_name_edit-avatar"),ne=new z(u,Z),re=new z(u,ee),oe=new z(u,te),ie=new function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),N(this,"renderItems",(function(e){e.forEach(r.addItem)})),N(this,"addItem",(function(e){var t=r._renderer(e);r._container.prepend(t)})),this._renderer=t,this._container=document.querySelector(n)}((function(e){var t={addLike:function(){return F.addLike(e._id)},removeLike:function(){return F.removeLike(e._id)},deleteCard:function(){return F.deleteCard(e._id)}};return new c(M(M({},e),{},{liked:e.likes.some((function(e){return e._id===F.userId}))}),M(M({},l),{},{openPicture:function(){return K.open(e)}}),Y.open,t).generateCard(e.owner._id===F.userId)}),".gallery__container");function ae(e){ie.renderItems(e.reverse())}var ce=document.querySelector(".profile__edit-button"),ue=document.querySelector(".profile__add-button"),se=document.querySelector(".profile__avatar");ce.addEventListener("click",(function(e){e.stopPropagation();var t=G.getUserInfo(),n=t.name,r=t.bio;Q.open({name:n,bio:r})})),ue.addEventListener("click",(function(e){e.stopPropagation(),W.open({})})),se.addEventListener("click",(function(e){e.stopPropagation(),X.open({})})),ne.enableValidation(),re.enableValidation(),oe.enableValidation(),F.getUserInfo().then((function(e){G.setUserInfo(e),G.setUserAvatar(e.avatar)})).then((function(){return F.getCards().then(ae)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TSxFQUFLa00sTUFBTWpNLE1BQU00SixFQUFJOUssVVAxRHBCLHVCTzhDL0IsU0FBU29OLEdBQWdCQyxHQUN2QnpCLEdBQWUwQixZQUFZRCxFQUFNRSxXQWtCbkMsSUFBTUMsR0FBYW5KLFNBQVNDLGNQcEdELHlCT3FHckJtSixHQUFZcEosU0FBU0MsY1BwR0Qsd0JPcUdwQm9KLEdBQWVySixTQUFTQyxjUHBHRyxvQk9zR2pDa0osR0FBV3JJLGlCQUFpQixTQUs1QixTQUErQmlCLEdBQzdCQSxFQUFFdUgsa0JBRUYsTUFBb0IzQyxFQUFZNEMsY0FBekJsTSxFQUFQLEVBQU9BLEtBQU00SCxFQUFiLEVBQWFBLElBQ2I0QixFQUFVK0IsS0FBSyxDQUFDdkwsS0FBQUEsRUFBTTRILElBQUFBLE9BUnhCbUUsR0FBVXRJLGlCQUFpQixTQVkzQixTQUE4QmlCLEdBQzVCQSxFQUFFdUgsa0JBRUZsQyxFQUFTd0IsS0FBSyxPQWRoQlMsR0FBYXZJLGlCQUFpQixTQWtCOUIsU0FBK0JpQixHQUM3QkEsRUFBRXVILGtCQUVGNUIsRUFBWWtCLEtBQUssT0FPbkJ6QixHQUFxQnFDLG1CQUNyQi9CLEdBQXFCK0IsbUJBQ3JCMUIsR0FBb0IwQixtQkFNcEIvQyxFQUFJOEMsY0FBYzdNLE1BQUssU0FBQUUsR0FDckIrSixFQUFZTSxZQUFZckssR0FDeEIrSixFQUFZaUIsY0FBY2hMLEVBQUtJLFdBRWhDTixNQUFLLGtCQUNKK0osRUFBSWdELFdBQ0gvTSxLQUFLcU0sTyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9WYWxpZGF0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Ioe2hvc3QsIGF1dGhvcml6YXRpb259KSB7XG4gICAgdGhpcy5faG9zdCA9IGhvc3Q7XG4gICAgdGhpcy5faGVhZGVycyA9IHsgYXV0aG9yaXphdGlvbiB9XG4gICAgdGhpcy51c2VySWQgPSB1bmRlZmluZWQ7XG4gIH1cbiAgX2hhbmRsZVJlc3BvbnNlKHJlcyl7XG4gICAgaWYocmVzLm9rKVxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBlcnJvcjogJHtyZXMuc3RhdHVzfSwgJHtyZXMuc3RhdHVzVGV4dH1gKTtcbiAgfVxuICBfaGFuZGxlRXJyb3IoZXJyb3Ipe1xuICAgIGNvbnNvbGUubG9nKGVycm9yKVxuICB9XG4gIGdldFVzZXJJbmZvKGlkPSdtZScpe1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9ob3N0fS91c2Vycy8ke2lkfWAse2hlYWRlcnM6IHRoaXMuX2hlYWRlcnN9KVxuICAgIC50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKVxuICAgIC50aGVuKGRhdGEgPT4ge1xuICAgICAgdGhpcy51c2VySWQgPSBkYXRhLl9pZDtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH0pXG4gICAgLmNhdGNoKHRoaXMuX2hhbmRsZUVycm9yKVxuICB9XG4gIHVwZGF0ZVVzZXJBdmF0YXIoYXZhdGFyKXtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5faG9zdH0vdXNlcnMvbWUvYXZhdGFyYCx7XG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIC4uLnRoaXMuX2hlYWRlcnMsXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXJcbiAgICAgIH0pfSlcbiAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSlcbiAgICAuY2F0Y2godGhpcy5faGFuZGxlRXJyb3IpXG4gIH1cbiAgZ2V0Q2FyZHMoKXtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5faG9zdH0vY2FyZHNgLHtoZWFkZXJzOiB0aGlzLl9oZWFkZXJzfSlcbiAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSlcbiAgICAuY2F0Y2godGhpcy5faGFuZGxlRXJyb3IpXG4gIH1cbiAgdXBkYXRlVXNlcih7bmFtZSxhYm91dH0pe1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9ob3N0fS91c2Vycy9tZWAse1xuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAuLi50aGlzLl9oZWFkZXJzLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXRcbiAgICAgIH0pfSlcbiAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSlcbiAgICAuY2F0Y2godGhpcy5faGFuZGxlRXJyb3IpXG4gIH1cbiAgYWRkQ2FyZCh7bmFtZSxsaW5rfSl7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2hvc3R9L2NhcmRzYCx7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgLi4udGhpcy5faGVhZGVycyxcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmtcbiAgICAgIH0pfSlcbiAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSlcbiAgICAuY2F0Y2godGhpcy5faGFuZGxlRXJyb3IpXG4gIH1cbiAgZGVsZXRlQ2FyZChpZCl7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2hvc3R9L2NhcmRzLyR7aWR9YCwge21ldGhvZDogJ0RFTEVURScsIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnN9KVxuICAgIC50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKVxuICB9XG4gIGFkZExpa2UoaWQpe1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9ob3N0fS9jYXJkcy9saWtlcy8ke2lkfWAsIHttZXRob2Q6ICdQVVQnLCBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzfSlcbiAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSlcbiAgfVxuICByZW1vdmVMaWtlKGlkKXtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5faG9zdH0vY2FyZHMvbGlrZXMvJHtpZH1gLCB7bWV0aG9kOiAnREVMRVRFJywgaGVhZGVyczogdGhpcy5faGVhZGVyc30pXG4gICAgLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpXG4gICAgLmNhdGNoKHRoaXMuX2hhbmRsZUVycm9yKVxuICB9XG59XG4iLCJjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3Ioe25hbWUsIGxpbmssIGxpa2VzLCBsaWtlZH0sIGFzc2V0cywgY29uZmlybURlbGV0ZSwge2FkZExpa2UsIHJlbW92ZUxpa2UsIGRlbGV0ZUNhcmR9KSB7XG5cbiAgICAvL2RhdGFcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLl9saWtlQ291bnQgPSBsaWtlcy5sZW5ndGg7XG4gICAgdGhpcy5faXNsaWtlZCA9IGxpa2VkO1xuXG4gICAgLy8gc2VsZWN0b3JzXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gYXNzZXRzLmNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9jYXJkVGVtcGxhdGVTZWxlY3RvciA9IGFzc2V0cy5jYXJkVGVtcGxhdGVTZWxlY3RvcjtcbiAgICB0aGlzLl9jYXJkVGl0bGVTZWxlY3RvciA9IGFzc2V0cy5jYXJkVGl0bGVTZWxlY3RvcjtcbiAgICB0aGlzLl9jYXJkSW1hZ2VTZWxlY3RvciA9IGFzc2V0cy5jYXJkSW1hZ2VTZWxlY3RvcjtcbiAgICB0aGlzLl9jYXJkTGlrZVNlbGVjdG9yID0gYXNzZXRzLmNhcmRMaWtlU2VsZWN0b3I7XG4gICAgdGhpcy5fY2FyZExpa2VzQ291bnRlclNlbGVjdG9yID0gYXNzZXRzLmNhcmRMaWtlQ291bnRlclNlbGVjdG9yO1xuICAgIHRoaXMuX2NhcmREZWxldGVTZWxlY3RvciA9IGFzc2V0cy5jYXJkRGVsZXRlU2VsZWN0b3I7XG5cbiAgICAvLyBib3VuZCBoYW5kbGVyczpcbiAgICB0aGlzLl9oYW5kbGVMaWtlID0gdGhpcy5faGFuZGxlTGlrZUNsaWNrLmJpbmQodGhpcyk7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlID0gdGhpcy5faGFuZGxlQ2FyZERlbGV0ZS5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5faGFuZGxlUGljdHVyZSA9IGFzc2V0cy5vcGVuUGljdHVyZTtcbiAgICB0aGlzLl9jb25maXJtID0gY29uZmlybURlbGV0ZTtcbiAgICB0aGlzLl9hZGRMaWtlQXBpID0gYWRkTGlrZTtcbiAgICB0aGlzLl9yZW1vdmVMaWtlQXBpID0gcmVtb3ZlTGlrZTtcbiAgICB0aGlzLl9kZWxldGVDYXJkQXBpID0gZGVsZXRlQ2FyZDtcblxuICAgIHRoaXMuX2FjdGl2ZUxpa2VCdXR0b25DbGFzcyA9IGFzc2V0cy5hY3RpdmVMaWtlQnV0dG9uQ2xhc3M7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkVGVtcGxhdGVTZWxlY3RvcikuY29udGVudDtcbiAgICByZXR1cm4gY2FyZFRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKS5jbG9uZU5vZGUodHJ1ZSk7XG4gIH1cblxuICBfaGFuZGxlQ2FyZERlbGV0ZSgpIHtcbiAgICB0aGlzLl9jb25maXJtKCgpID0+e1xuICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICAgICAgdGhpcy5fZGVsZXRlQ2FyZEFwaSgpO1xuICAgIH0pXG4gIH1cblxuICBfaGFuZGxlTGlrZUNsaWNrKCkge1xuICAgIGNvbnN0IGxpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZExpa2VTZWxlY3Rvcik7XG4gICAgaWYodGhpcy5faXNsaWtlZCl7XG4gICAgICB0aGlzLl9pc2xpa2VkID0gZmFsc2U7XG4gICAgICB0aGlzLl9saWtlQ291bnQtLTtcbiAgICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9hY3RpdmVMaWtlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRMaWtlc0NvdW50ZXJTZWxlY3RvcikudGV4dENvbnRlbnQgPSBgJHt0aGlzLl9saWtlQ291bnR9YDtcbiAgICAgIHRoaXMuX3JlbW92ZUxpa2VBcGkoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLl9pc2xpa2VkID0gdHJ1ZTtcbiAgICAgIHRoaXMuX2xpa2VDb3VudCsrO1xuICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2FjdGl2ZUxpa2VCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZExpa2VzQ291bnRlclNlbGVjdG9yKS50ZXh0Q29udGVudCA9IGAke3RoaXMuX2xpa2VDb3VudH1gO1xuICAgICAgdGhpcy5fYWRkTGlrZUFwaSgpO1xuICAgIH1cbiAgfVxuXG4gIF9hZGRDYXJkRXZlbnRzKGlzQ2FyZE93bmVyKXtcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZEltYWdlU2VsZWN0b3IpO1xuICAgIGNvbnN0IGNhcmRMaWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRMaWtlU2VsZWN0b3IpO1xuICAgIGNvbnN0IGNhcmREZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZERlbGV0ZVNlbGVjdG9yKTtcblxuICAgIGlmKGlzQ2FyZE93bmVyKXtcbiAgICAgIGNhcmREZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVEZWxldGUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGNhcmREZWxldGVCdXR0b24ucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5faGFuZGxlUGljdHVyZSk7XG4gICAgY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVMaWtlKTtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZChpc0NhcmRPd25lcj1mYWxzZSl7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG5cbiAgICB0aGlzLl9hZGRDYXJkRXZlbnRzKGlzQ2FyZE93bmVyKTtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFRpdGxlU2VsZWN0b3IpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZExpa2VzQ291bnRlclNlbGVjdG9yKS50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VDb3VudDtcbiAgICBpZih0aGlzLl9pc2xpa2VkKVxuICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRMaWtlU2VsZWN0b3IpLmNsYXNzTGlzdC5hZGQodGhpcy5fYWN0aXZlTGlrZUJ1dHRvbkNsYXNzKTtcbiAgICBjb25zdCBpbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkSW1hZ2VTZWxlY3Rvcik7XG4gICAgaW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICBpbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcbiIsIi8qXG4gIERPTSBlbGVtZW50czpcbiovXG5cbi8vIEZvcm1zXG5jb25zdCBwcm9maWxlRm9ybVNlbGVjdG9yID0gJy5mb3JtX25hbWVfZWRpdC1wcm9maWxlJztcbmNvbnN0IHBpY3R1cmVGb3JtU2VsZWN0b3IgPSAnLmZvcm1fbmFtZV9uZXctcGxhY2UnO1xuY29uc3QgYXZhdGFyRm9ybVNlbGVjdG9yID0gJy5mb3JtX25hbWVfZWRpdC1hdmF0YXInO1xuY29uc3QgZm9ybVNlbGVjdG9ycyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19zYXZlLWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX3NhdmUtYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yX3Zpc2libGVcIlxufVxuXG4vLyBCdXR0b25zXG5jb25zdCBlZGl0QnV0dG9uU2VsZWN0b3IgPSAnLnByb2ZpbGVfX2VkaXQtYnV0dG9uJztcbmNvbnN0IGFkZEJ1dHRvblNlbGVjdG9yID0gJy5wcm9maWxlX19hZGQtYnV0dG9uJztcbmNvbnN0IGVkaXRBdmF0YXJCdXR0b25TZWxlY3RvciA9ICcucHJvZmlsZV9fYXZhdGFyJztcblxuLy8gUHJvZmlsZVxuY29uc3QgcHJvZmlsZVNlbGVjdG9ycyA9IHtcbiAgdXNlck5hbWVTZWxlY3RvcjogJy5wcm9maWxlX19uYW1lJyxcbiAgZGVzY3JpcHRpb25TZWxlY3RvcjogJy5wcm9maWxlX19iaW8nLFxuICBhdmF0YXJTZWxlY3RvcjogJy5wcm9maWxlX19pbWFnZSdcbn07XG5cbi8vIFBvcHVwc1xuY29uc3QgZWRpdFByb2ZpbGVQb3B1cFNlbGVjdG9yID0gJy5wb3B1cF9uYW1lX2VkaXQtcHJvZmlsZSc7XG5jb25zdCBhZGRDYXJkUG9wdXBTZWxlY3RvciA9ICcucG9wdXBfbmFtZV9uZXctcGxhY2UnO1xuY29uc3QgcGljdHVyZVBvcHVwU2VsZWN0b3IgPSAnLnBvcHVwX25hbWVfcGljdHVyZSc7XG5jb25zdCBhdmF0YXJQb3B1cFNlbGVjdG9yID0gJy5wb3B1cF9uYW1lX2VkaXQtYXZhdGFyJztcbmNvbnN0IGNvbmZpcm1Qb3B1cFNlbGVjdG9yID0gJy5wb3B1cF9uYW1lX2NvbmZpcm0nO1xuXG5jb25zdCBhY3RpdmVQb3B1cENsYXNzID0gXCJwb3B1cF92aXNpYmxlXCI7XG5jb25zdCBwb3B1cENsb3NlQnV0dG9uU2VsZWN0b3IgPSAnLnBvcHVwX19jbG9zZS1idXR0b24nO1xuY29uc3QgcG9wdXBUaXRsZVNlbGVjdG9yID0gJy5wb3B1cF9fcGljdHVyZS10aXRsZSc7XG5jb25zdCBwb3B1cEltYWdlU2VsZWN0b3IgPSAnLnBvcHVwX19waWN0dXJlJztcblxuXG4vLyBDYXJkc1xuY29uc3QgY2FyZFNlbGVjdG9ycyA9IHtcbiAgY2FyZFNlbGVjdG9yOiBcIi5jYXJkXCIsXG4gIGNhcmRUZW1wbGF0ZVNlbGVjdG9yOiBcIi5jYXJkX190ZW1wbGF0ZVwiLFxuICBjYXJkVGl0bGVTZWxlY3RvcjogXCIuY2FyZF9fdGl0bGVcIixcbiAgY2FyZEltYWdlU2VsZWN0b3I6IFwiLmNhcmRfX2ltYWdlXCIsXG4gIGNhcmRMaWtlU2VsZWN0b3I6IFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIsXG4gIGNhcmRMaWtlQ291bnRlclNlbGVjdG9yOiBcIi5jYXJkX19saWtlLWNvdW50ZXJcIixcbiAgY2FyZERlbGV0ZVNlbGVjdG9yOiBcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIsXG4gIGFjdGl2ZUxpa2VCdXR0b25DbGFzczogXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIlxufVxuY29uc3QgY2FyZHNDb250YWluZXJTZWxlY3RvciA9ICcuZ2FsbGVyeV9fY29udGFpbmVyJztcblxuLypcbiAgQXBpOlxuKi9cbmNvbnN0IGFwaUtleSA9IHtcbiAgaG9zdDogcHJvY2Vzcy5lbnYuSE9TVCxcbiAgdG9rZW46IHByb2Nlc3MuZW52LlRPS0VOXG59XG5cbmV4cG9ydCB7YXBpS2V5LCBmb3JtU2VsZWN0b3JzLCBhY3RpdmVQb3B1cENsYXNzLCBjYXJkU2VsZWN0b3JzLCBlZGl0QnV0dG9uU2VsZWN0b3IsIGFkZEJ1dHRvblNlbGVjdG9yLCBlZGl0QXZhdGFyQnV0dG9uU2VsZWN0b3IsIGVkaXRQcm9maWxlUG9wdXBTZWxlY3RvciwgYWRkQ2FyZFBvcHVwU2VsZWN0b3IsIHBpY3R1cmVQb3B1cFNlbGVjdG9yLCBhdmF0YXJQb3B1cFNlbGVjdG9yLCBjb25maXJtUG9wdXBTZWxlY3RvciwgY2FyZHNDb250YWluZXJTZWxlY3RvciwgcHJvZmlsZUZvcm1TZWxlY3RvciwgcGljdHVyZUZvcm1TZWxlY3RvciwgYXZhdGFyRm9ybVNlbGVjdG9yLCBwb3B1cENsb3NlQnV0dG9uU2VsZWN0b3IsIHBvcHVwVGl0bGVTZWxlY3RvciwgcG9wdXBJbWFnZVNlbGVjdG9yLCBwcm9maWxlU2VsZWN0b3JzfTtcbiIsImltcG9ydCB7IGFjdGl2ZVBvcHVwQ2xhc3MsIHBvcHVwQ2xvc2VCdXR0b25TZWxlY3RvciB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwQ2xvc2VCdXR0b25TZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlQ2xvc2VCdXR0b24gPSAoKSA9PiB0aGlzLmNsb3NlKCk7XG4gIH1cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9lbGVtZW50LmNsYXNzTGlzdC5hZGQoYWN0aXZlUG9wdXBDbGFzcyk7XG4gICAgdGhpcy5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX2VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShhY3RpdmVQb3B1cENsYXNzKTtcbiAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbiAgX2hhbmRsZUVzY2FwZUNsb3NlID0gKGUpID0+IHtcbiAgICBpZihlLmtleT09PSdFc2NhcGUnKVxuICAgICAgdGhpcy5jbG9zZSgpO1xuICB9XG4gIF9oYW5kbGVPdmVybGF5Q2xvc2UgPSAoZSkgPT4ge1xuICAgIGlmKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhhY3RpdmVQb3B1cENsYXNzKSlcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgfVxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZUNsb3NlQnV0dG9uKTtcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5faGFuZGxlT3ZlcmxheUNsb3NlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjYXBlQ2xvc2UpO1xuICB9XG4gIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5faGFuZGxlQ2xvc2VCdXR0b24pO1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NhcGVDbG9zZSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuaW1wb3J0IHsgZm9ybVNlbGVjdG9ycyB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3RvcihzZWxlY3Rvciwge2hhbmRsZVN1Ym1pdCwgcmVzZXRWYWxpZGF0aW9ufSkge1xuICAgIHN1cGVyKHNlbGVjdG9yKTtcblxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX3Jlc2V0VmFsaWRhdGlvbiA9IHJlc2V0VmFsaWRhdGlvbjtcblxuICAgIHRoaXMuX2lucHV0cyA9IEFycmF5LmZyb20odGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGZvcm1TZWxlY3RvcnMuaW5wdXRTZWxlY3RvcikpO1xuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoZm9ybVNlbGVjdG9ycy5mb3JtU2VsZWN0b3IpO1xuICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3Rvcihmb3JtU2VsZWN0b3JzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICAgIHRoaXMuX2J1dHRvblRleHQgPSAnU2F2aW5nLi4uJztcbiAgfVxuICBfc2V0SW5wdXRWYWx1ZXMgPSAodmFsdWVzKSA9PiB7XG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXModmFsdWVzKSkge1xuICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLl9pbnB1dHMuZmluZChpbnB1dCA9PiBpbnB1dC5uYW1lID09PSBrZXkpO1xuICAgICAgaWYodHlwZW9mIGlucHV0ICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgaW5wdXQudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG4gIH1cbiAgX2dldElucHV0VmFsdWVzID0gKCkgPT4ge1xuICAgIGNvbnN0IHZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgIHZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiB2YWx1ZXM7XG4gIH1cbiAgb3BlbiA9ICh2YWx1ZXMpID0+IHtcbiAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fc2V0SW5wdXRWYWx1ZXModmFsdWVzKTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbiAgY2xvc2UgPSAoKSA9PiB7XG4gICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3Jlc2V0VmFsaWRhdGlvbigpO1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICB9XG4gIHNldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5faGFuZGxlU3VibWl0KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG4gIHJlbW92ZUV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMuX2Zvcm0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5faGFuZGxlU3VibWl0KTtcbiAgICBzdXBlci5yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICB9XG4gIHRvZ2dsZUJ1dHRvblRleHQgPSAoKSA9PiB7XG4gICAgY29uc3QgYnV0dG9uVGV4dCA9IHRoaXMuX2J1dHRvbi50ZXh0Q29udGVudDtcbiAgICB0aGlzLl9idXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9idXR0b25UZXh0O1xuICAgIHRoaXMuX2J1dHRvblRleHQgPSBidXR0b25UZXh0O1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcbmltcG9ydCB7IHBvcHVwVGl0bGVTZWxlY3RvciwgcG9wdXBJbWFnZVNlbGVjdG9yIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3RvcihzZWxlY3Rvcikge1xuICAgIHN1cGVyKHNlbGVjdG9yKTtcbiAgICB0aGlzLl90aXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFRpdGxlU2VsZWN0b3IpO1xuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwSW1hZ2VTZWxlY3Rvcik7XG4gIH1cbiAgb3Blbih7bGluaywgbmFtZX0pIHtcbiAgICB0aGlzLl90aXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5faW1hZ2Uuc2V0QXR0cmlidXRlKCdzcmMnLCBsaW5rKTtcbiAgICB0aGlzLl9pbWFnZS5zZXRBdHRyaWJ1dGUoJ2FsdCcsIG5hbWUpO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3Ioc2VsZWN0b3IsIGJ1dHRvblNlbGVjdG9yKXtcbiAgICBzdXBlcihzZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlQ29uZmlybSA9ICgpID0+IHRoaXMuY2xvc2UoKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGJ1dHRvblNlbGVjdG9yKTtcbiAgfVxuICBvcGVuID0gKGhhbmRsZUNvbmZpcm0pID0+IHtcbiAgICB0aGlzLl9oYW5kbGVDb25maXJtID0gKCkgPT4ge1xuICAgICAgaGFuZGxlQ29uZmlybSgpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG4gIGNsb3NlID0gKCkgPT4ge1xuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG4gIHNldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVDb25maXJtKTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG4gIHJlbW92ZUV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVDb25maXJtKTtcbiAgICBzdXBlci5yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHt1c2VyTmFtZVNlbGVjdG9yLCBkZXNjcmlwdGlvblNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcn0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fYmlvRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb25TZWxlY3Rvcik7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCwgYmlvOiB0aGlzLl9iaW9FbGVtZW50LnRleHRDb250ZW50fTtcbiAgfVxuICBzZXRVc2VySW5mbyh7bmFtZSwgYWJvdXR9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2Jpb0VsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxuICBzZXRVc2VyQXZhdGFyKGxpbmspe1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSBsaW5rO1xuICB9XG59XG4iLCJjbGFzcyBWYWxpZGF0aW9uIHtcbiAgY29uc3RydWN0b3Ioe2lucHV0U2VsZWN0b3IsIHN1Ym1pdEJ1dHRvblNlbGVjdG9yLCBpbmFjdGl2ZUJ1dHRvbkNsYXNzLCBpbnB1dEVycm9yQ2xhc3MsIGVycm9yQ2xhc3N9LCBmb3JtKSB7XG4gICAgdGhpcy5fZm9ybSA9IGZvcm07XG5cbiAgICAvLyBzZWxlY3RvcnNcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuXG4gICAgLy8gY2xhc3Nlc1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBpbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gZXJyb3JDbGFzcztcblxuICAgIHRoaXMuX2JvdW5kSGFuZGxlSW5wdXQgPSB0aGlzLl9oYW5kbGVJbnB1dC5iaW5kKHRoaXMpO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goaW5wdXQ9PntcbiAgICAgIHRoaXMuX2hpZGVFcnJvcihpbnB1dCk7XG4gICAgfSk7XG4gICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xuICB9XG5cbiAgX2hhbmRsZUlucHV0KGUpe1xuICAgIHRoaXMuX3ZhbGlkYXRlSW5wdXQoZS50YXJnZXQpO1xuICAgIHRoaXMuX3NldEJ1dHRvblN0YXRlKCk7XG4gIH1cblxuICBfdmFsaWRhdGVJbnB1dChpbnB1dCkge1xuICAgIGlmKGlucHV0LnZhbGlkaXR5LnZhbGlkKXtcbiAgICAgIHRoaXMuX2hpZGVFcnJvcihpbnB1dCk7XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB0aGlzLl9zaG93RXJyb3IoaW5wdXQpO1xuICAgIH1cbiAgfVxuXG4gIF9oaWRlRXJyb3IoaW5wdXQpIHtcbiAgICBjb25zdCBlcnJvciA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XG4gICAgZXJyb3IudGV4dENvbnRlbnQgPSAnJztcbiAgICBlcnJvci5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9zaG93RXJyb3IoaW5wdXQpIHtcbiAgICBjb25zdCBlcnJvciA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XG4gICAgZXJyb3IudGV4dENvbnRlbnQgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvci5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goaW5wdXQgPT4gaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLl9ib3VuZEhhbmRsZUlucHV0KSk7XG4gIH1cblxuICBfc2V0QnV0dG9uU3RhdGUoKSB7XG4gICAgaWYodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5faW5wdXRFbGVtZW50cykuc29tZShpbnB1dD0+IWlucHV0LnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIF9lbmFibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBWYWxpZGF0aW9uO1xuIiwiLy8gc3R5bGU6XG5pbXBvcnQgJy4vaW5kZXguY3NzJztcblxuLy8gY29tcG9uZW50czpcbmltcG9ydCBBcGkgZnJvbSAnLi4vY29tcG9uZW50cy9BcGknXG5pbXBvcnQgQ2FyZCBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQnO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtJztcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlJztcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24nXG5pbXBvcnQgVXNlckluZm8gZnJvbSAnLi4vY29tcG9uZW50cy9Vc2VySW5mbyc7XG5pbXBvcnQgU2VjdGlvbiAgZnJvbSAnLi4vY29tcG9uZW50cy9TZWN0aW9uJztcbmltcG9ydCBWYWxpZGF0aW9uIGZyb20gJy4uL2NvbXBvbmVudHMvVmFsaWRhdGlvbic7XG5pbXBvcnQge2FwaUtleSwgcHJvZmlsZVNlbGVjdG9ycywgZm9ybVNlbGVjdG9ycywgY2FyZFNlbGVjdG9ycywgZWRpdEJ1dHRvblNlbGVjdG9yLCBhZGRCdXR0b25TZWxlY3RvciwgZWRpdEF2YXRhckJ1dHRvblNlbGVjdG9yLCBhdmF0YXJQb3B1cFNlbGVjdG9yLCBjb25maXJtUG9wdXBTZWxlY3RvciwgZWRpdFByb2ZpbGVQb3B1cFNlbGVjdG9yLCBhZGRDYXJkUG9wdXBTZWxlY3RvciwgcGljdHVyZVBvcHVwU2VsZWN0b3IsIGNhcmRzQ29udGFpbmVyU2VsZWN0b3IsIHByb2ZpbGVGb3JtU2VsZWN0b3IsIHBpY3R1cmVGb3JtU2VsZWN0b3IsIGF2YXRhckZvcm1TZWxlY3RvciwgaW5pdGlhbENhcmRzfSBmcm9tICcuLi9jb21wb25lbnRzL2NvbnN0YW50cydcblxuLypcbiAgQVBJOlxuKi9cblxuY29uc3QgYXBpID0gbmV3IEFwaSh7aG9zdDogYXBpS2V5Lmhvc3QsIGF1dGhvcml6YXRpb246IGFwaUtleS50b2tlbn0pO1xuXG4vKlxuICBQcm9maWxlOlxuKi9cblxuY29uc3QgcHJvZmlsZVZpZXcgPSBuZXcgVXNlckluZm8ocHJvZmlsZVNlbGVjdG9ycyk7XG5cbi8qXG4gIFBvcHVwczpcbiovXG5cbmNvbnN0IHBpY3R1cmVQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShwaWN0dXJlUG9wdXBTZWxlY3Rvcik7XG5jb25zdCBlZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShlZGl0UHJvZmlsZVBvcHVwU2VsZWN0b3IsIHtoYW5kbGVTdWJtaXQ6IGhhbmRsZVByb2ZpbGVTdWJtaXQsIHJlc2V0VmFsaWRhdGlvbjogKCk9PnByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpfSk7XG5jb25zdCBhZGRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKGFkZENhcmRQb3B1cFNlbGVjdG9yLCB7aGFuZGxlU3VibWl0OiBoYW5kbGVQbGFjZVN1Ym1pdCwgcmVzZXRWYWxpZGF0aW9uOiAoKT0+cGljdHVyZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCl9KTtcbmNvbnN0IGF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oYXZhdGFyUG9wdXBTZWxlY3Rvciwge2hhbmRsZVN1Ym1pdDogaGFuZGxlQXZhdGFyU3VibWl0LCByZXNldFZhbGlkYXRpb246ICgpPT5hdmF0YXJGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpfSk7XG5jb25zdCBjb25maXJtUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKGNvbmZpcm1Qb3B1cFNlbGVjdG9yLCBmb3JtU2VsZWN0b3JzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuLypcbiAgRm9ybXM6XG4qL1xuXG5jb25zdCBwcm9maWxlRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVGb3JtU2VsZWN0b3IpO1xuY29uc3QgcGljdHVyZUZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihwaWN0dXJlRm9ybVNlbGVjdG9yKTtcbmNvbnN0IGF2YXRhckZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJGb3JtU2VsZWN0b3IpO1xuXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBWYWxpZGF0aW9uKGZvcm1TZWxlY3RvcnMsIHByb2ZpbGVGb3JtRWxlbWVudCk7XG5jb25zdCBwaWN0dXJlRm9ybVZhbGlkYXRvciA9IG5ldyBWYWxpZGF0aW9uKGZvcm1TZWxlY3RvcnMsIHBpY3R1cmVGb3JtRWxlbWVudCk7XG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IFZhbGlkYXRpb24oZm9ybVNlbGVjdG9ycywgYXZhdGFyRm9ybUVsZW1lbnQpO1xuXG4vLyBQbGFjZSBmb3JtIGRhdGEgaGFuZGxlclxuZnVuY3Rpb24gaGFuZGxlUGxhY2VTdWJtaXQoZSkge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgdGhpcy50b2dnbGVCdXR0b25UZXh0KCk7XG5cbiAgY29uc3Qge3RpdGxlOiBuYW1lLCBsaW5rfSA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XG4gIGFwaS5hZGRDYXJkKHtuYW1lLCBsaW5rfSkudGhlbihkYXRhID0+IGdhbGxlcnlTZWN0aW9uLmFkZEl0ZW0oZGF0YSkpXG4gIC50aGVuKCgpID0+IHtcbiAgICB0aGlzLmNsb3NlKCk7XG4gICAgdGhpcy50b2dnbGVCdXR0b25UZXh0KCk7XG4gIH0pO1xufVxuXG4vLyBQcm9maWxlIGZvcm0gZGF0YSBoYW5kbGVyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlU3VibWl0KGUpIHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIHRoaXMudG9nZ2xlQnV0dG9uVGV4dCgpO1xuXG4gIGNvbnN0IHtuYW1lLCBiaW86IGFib3V0fSA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XG4gIHByb2ZpbGVWaWV3LnNldFVzZXJJbmZvKHtuYW1lLCBhYm91dH0pXG4gIGFwaS51cGRhdGVVc2VyKHtuYW1lLCBhYm91dH0pXG4gIC50aGVuKCgpID0+IHtcbiAgICB0aGlzLmNsb3NlKCk7XG4gICAgdGhpcy50b2dnbGVCdXR0b25UZXh0KCk7XG4gIH0pO1xufVxuXG4vLyBBdmF0YXIgZm9ybSBzdWJtaXRcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChlKXtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIHRoaXMudG9nZ2xlQnV0dG9uVGV4dCgpO1xuXG4gIGNvbnN0IHt1cmx9ID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcblxuICBwcm9maWxlVmlldy5zZXRVc2VyQXZhdGFyKHVybCk7XG4gIGFwaS51cGRhdGVVc2VyQXZhdGFyKHVybClcbiAgLnRoZW4oKCkgPT4ge1xuICAgIHRoaXMuY2xvc2UoKTtcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblRleHQoKTtcbiAgfSk7XG59XG5cbi8qXG4gIENhcmRzOlxuKi9cblxuY29uc3QgZ2FsbGVyeVNlY3Rpb24gPSBuZXcgU2VjdGlvbihhZGROZXdDYXJkLCBjYXJkc0NvbnRhaW5lclNlbGVjdG9yKTtcblxuZnVuY3Rpb24gZ2V0Q2FyZHNGcm9tQXBpKGNhcmRzKXtcbiAgZ2FsbGVyeVNlY3Rpb24ucmVuZGVySXRlbXMoY2FyZHMucmV2ZXJzZSgpKTtcbn1cblxuZnVuY3Rpb24gYWRkTmV3Q2FyZChkYXRhKXtcbiAgY29uc3QgY2FyZEFwaUZ1bmN0aW9ucyA9IHtcbiAgICBhZGRMaWtlOiAoKSA9PiBhcGkuYWRkTGlrZShkYXRhLl9pZCksXG4gICAgcmVtb3ZlTGlrZTogKCkgPT4gYXBpLnJlbW92ZUxpa2UoZGF0YS5faWQpLFxuICAgIGRlbGV0ZUNhcmQ6ICgpID0+IGFwaS5kZWxldGVDYXJkKGRhdGEuX2lkKVxuICB9XG5cbiAgY29uc3QgbmV3Q2FyZCA9IG5ldyBDYXJkKHsuLi5kYXRhLCBsaWtlZDogZGF0YS5saWtlcy5zb21lKG9iaj0+b2JqLl9pZD09PWFwaS51c2VySWQpfSwgey4uLmNhcmRTZWxlY3RvcnMsIG9wZW5QaWN0dXJlOiAoKSA9PiBwaWN0dXJlUG9wdXAub3BlbihkYXRhKX0sIGNvbmZpcm1Qb3B1cC5vcGVuLCBjYXJkQXBpRnVuY3Rpb25zKTtcbiAgcmV0dXJuIG5ld0NhcmQuZ2VuZXJhdGVDYXJkKGRhdGEub3duZXIuX2lkPT09YXBpLnVzZXJJZCk7XG59XG5cbi8qXG4gIFBhZ2UgQnV0dG9uczpcbiovXG5cbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVkaXRCdXR0b25TZWxlY3Rvcik7XG5jb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGFkZEJ1dHRvblNlbGVjdG9yKTtcbmNvbnN0IGF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWRpdEF2YXRhckJ1dHRvblNlbGVjdG9yKTtcblxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUVkaXRCdXR0b25DbGljayk7XG5hZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVBZGRCdXR0b25DbGljayk7XG5hdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVFZGl0QXZhdGFyQ2xpY2spO1xuXG4vLyBFZGl0IGNsaWNrIGhhbmRsZXJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRCdXR0b25DbGljayhlKSB7XG4gIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgY29uc3Qge25hbWUsIGJpb30gPSBwcm9maWxlVmlldy5nZXRVc2VySW5mbygpO1xuICBlZGl0UG9wdXAub3Blbih7bmFtZSwgYmlvfSk7XG59XG5cbi8vIEFkZCBjbGljayBoYW5kbGVyXG5mdW5jdGlvbiBoYW5kbGVBZGRCdXR0b25DbGljayhlKSB7XG4gIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgYWRkUG9wdXAub3Blbih7fSk7XG59XG5cbi8vIEF2YXRhciBjbGljayBoYW5kbGVyXG5mdW5jdGlvbiBoYW5kbGVFZGl0QXZhdGFyQ2xpY2soZSl7XG4gIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgYXZhdGFyUG9wdXAub3Blbih7fSk7XG59XG5cbi8qXG4gIFZhbGlkYXRpb246XG4qL1xuXG5wcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5waWN0dXJlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuLypcbiAgTG9hZCBpbml0aWFsIEFwaSBkYXRhOlxuKi9cblxuYXBpLmdldFVzZXJJbmZvKCkudGhlbihkYXRhPT57XG4gIHByb2ZpbGVWaWV3LnNldFVzZXJJbmZvKGRhdGEpO1xuICBwcm9maWxlVmlldy5zZXRVc2VyQXZhdGFyKGRhdGEuYXZhdGFyKTtcbn0pXG4udGhlbigoKSA9PlxuICBhcGkuZ2V0Q2FyZHMoKVxuICAudGhlbihnZXRDYXJkc0Zyb21BcGkpXG4gICk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IocmVuZGVyZXIsIHNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgfVxuICByZW5kZXJJdGVtcyA9IChpdGVtcykgPT4ge1xuICAgIGl0ZW1zLmZvckVhY2godGhpcy5hZGRJdGVtKTtcbiAgfVxuICBhZGRJdGVtID0gKGVsZW1lbnQpID0+IHtcbiAgICBjb25zdCBuZXdFbGVtZW50ID0gdGhpcy5fcmVuZGVyZXIoZWxlbWVudCk7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQobmV3RWxlbWVudCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJBcGkiLCJob3N0IiwiYXV0aG9yaXphdGlvbiIsInRoaXMiLCJfaG9zdCIsIl9oZWFkZXJzIiwidXNlcklkIiwidW5kZWZpbmVkIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJpZCIsImZldGNoIiwiaGVhZGVycyIsInRoZW4iLCJfaGFuZGxlUmVzcG9uc2UiLCJkYXRhIiwiX2lkIiwiY2F0Y2giLCJfaGFuZGxlRXJyb3IiLCJhdmF0YXIiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm5hbWUiLCJhYm91dCIsImxpbmsiLCJDYXJkIiwiYXNzZXRzIiwiY29uZmlybURlbGV0ZSIsImxpa2VzIiwibGlrZWQiLCJhZGRMaWtlIiwicmVtb3ZlTGlrZSIsImRlbGV0ZUNhcmQiLCJfbmFtZSIsIl9saW5rIiwiX2xpa2VDb3VudCIsImxlbmd0aCIsIl9pc2xpa2VkIiwiX2NhcmRTZWxlY3RvciIsImNhcmRTZWxlY3RvciIsIl9jYXJkVGVtcGxhdGVTZWxlY3RvciIsImNhcmRUZW1wbGF0ZVNlbGVjdG9yIiwiX2NhcmRUaXRsZVNlbGVjdG9yIiwiY2FyZFRpdGxlU2VsZWN0b3IiLCJfY2FyZEltYWdlU2VsZWN0b3IiLCJjYXJkSW1hZ2VTZWxlY3RvciIsIl9jYXJkTGlrZVNlbGVjdG9yIiwiY2FyZExpa2VTZWxlY3RvciIsIl9jYXJkTGlrZXNDb3VudGVyU2VsZWN0b3IiLCJjYXJkTGlrZUNvdW50ZXJTZWxlY3RvciIsIl9jYXJkRGVsZXRlU2VsZWN0b3IiLCJjYXJkRGVsZXRlU2VsZWN0b3IiLCJfaGFuZGxlTGlrZSIsIl9oYW5kbGVMaWtlQ2xpY2siLCJiaW5kIiwiX2hhbmRsZURlbGV0ZSIsIl9oYW5kbGVDYXJkRGVsZXRlIiwiX2hhbmRsZVBpY3R1cmUiLCJvcGVuUGljdHVyZSIsIl9jb25maXJtIiwiX2FkZExpa2VBcGkiLCJfcmVtb3ZlTGlrZUFwaSIsIl9kZWxldGVDYXJkQXBpIiwiX2FjdGl2ZUxpa2VCdXR0b25DbGFzcyIsImFjdGl2ZUxpa2VCdXR0b25DbGFzcyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfZWxlbWVudCIsInJlbW92ZSIsImxpa2VCdXR0b24iLCJjbGFzc0xpc3QiLCJ0ZXh0Q29udGVudCIsImFkZCIsImlzQ2FyZE93bmVyIiwiY2FyZEltYWdlIiwiY2FyZExpa2VCdXR0b24iLCJjYXJkRGVsZXRlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9nZXRUZW1wbGF0ZSIsIl9hZGRDYXJkRXZlbnRzIiwiaW1hZ2UiLCJzcmMiLCJhbHQiLCJmb3JtU2VsZWN0b3JzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJhY3RpdmVQb3B1cENsYXNzIiwiY2FyZFNlbGVjdG9ycyIsIlBvcHVwIiwic2VsZWN0b3IiLCJlIiwia2V5IiwiY2xvc2UiLCJ0YXJnZXQiLCJjb250YWlucyIsIl9jbG9zZUJ1dHRvbiIsIl9oYW5kbGVDbG9zZUJ1dHRvbiIsInNldEV2ZW50TGlzdGVuZXJzIiwicmVtb3ZlRXZlbnRMaXN0ZW5lcnMiLCJfaGFuZGxlT3ZlcmxheUNsb3NlIiwiX2hhbmRsZUVzY2FwZUNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJyZXNldFZhbGlkYXRpb24iLCJ2YWx1ZXMiLCJ2YWx1ZSIsImlucHV0IiwiX2lucHV0cyIsImZpbmQiLCJPYmplY3QiLCJlbnRyaWVzIiwiZm9yRWFjaCIsIl9zZXRJbnB1dFZhbHVlcyIsIl9yZXNldFZhbGlkYXRpb24iLCJfZm9ybSIsInJlc2V0IiwiX2hhbmRsZVN1Ym1pdCIsImJ1dHRvblRleHQiLCJfYnV0dG9uIiwiX2J1dHRvblRleHQiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiUG9wdXBXaXRoSW1hZ2UiLCJfdGl0bGUiLCJfaW1hZ2UiLCJzZXRBdHRyaWJ1dGUiLCJQb3B1cFdpdGhDb25maXJtYXRpb24iLCJidXR0b25TZWxlY3RvciIsImhhbmRsZUNvbmZpcm0iLCJfaGFuZGxlQ29uZmlybSIsIl9idXR0b25FbGVtZW50IiwiVXNlckluZm8iLCJ1c2VyTmFtZVNlbGVjdG9yIiwiZGVzY3JpcHRpb25TZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2Jpb0VsZW1lbnQiLCJfaW1hZ2VFbGVtZW50IiwiYmlvIiwiVmFsaWRhdGlvbiIsImZvcm0iLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiX2JvdW5kSGFuZGxlSW5wdXQiLCJfaGFuZGxlSW5wdXQiLCJfaW5wdXRFbGVtZW50cyIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9oaWRlRXJyb3IiLCJfZGlzYWJsZUJ1dHRvbiIsIl92YWxpZGF0ZUlucHV0IiwiX3NldEJ1dHRvblN0YXRlIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9zaG93RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfZW5hYmxlQnV0dG9uIiwic29tZSIsImRpc2FibGVkIiwiYXBpIiwicHJvY2VzcyIsInByb2ZpbGVWaWV3IiwicGljdHVyZVBvcHVwIiwiZWRpdFBvcHVwIiwicHJldmVudERlZmF1bHQiLCJ0b2dnbGVCdXR0b25UZXh0IiwiX2dldElucHV0VmFsdWVzIiwic2V0VXNlckluZm8iLCJ1cGRhdGVVc2VyIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJhZGRQb3B1cCIsInRpdGxlIiwiYWRkQ2FyZCIsImdhbGxlcnlTZWN0aW9uIiwiYWRkSXRlbSIsInBpY3R1cmVGb3JtVmFsaWRhdG9yIiwiYXZhdGFyUG9wdXAiLCJ1cmwiLCJzZXRVc2VyQXZhdGFyIiwidXBkYXRlVXNlckF2YXRhciIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJjb25maXJtUG9wdXAiLCJwcm9maWxlRm9ybUVsZW1lbnQiLCJwaWN0dXJlRm9ybUVsZW1lbnQiLCJhdmF0YXJGb3JtRWxlbWVudCIsInJlbmRlcmVyIiwiaXRlbXMiLCJlbGVtZW50IiwibmV3RWxlbWVudCIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJwcmVwZW5kIiwiY2FyZEFwaUZ1bmN0aW9ucyIsIm9iaiIsIm9wZW4iLCJnZW5lcmF0ZUNhcmQiLCJvd25lciIsImdldENhcmRzRnJvbUFwaSIsImNhcmRzIiwicmVuZGVySXRlbXMiLCJyZXZlcnNlIiwiZWRpdEJ1dHRvbiIsImFkZEJ1dHRvbiIsImF2YXRhckJ1dHRvbiIsInN0b3BQcm9wYWdhdGlvbiIsImdldFVzZXJJbmZvIiwiZW5hYmxlVmFsaWRhdGlvbiIsImdldENhcmRzIl0sInNvdXJjZVJvb3QiOiIifQ==